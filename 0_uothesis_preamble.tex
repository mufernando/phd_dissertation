%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                              %
%       This is the beginning of a uothesisapa Dissertation                    %
%                                                                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\errorcontextlines 10000 % Get more logging information on errors. Following http://tex.stackexchange.com/a/83485/56363, if after setting this you see an error, "Note that the order is 'from inner to outer', that is, the first (non-indented) line is the point where the error actually occurred. The line after that (indented) is the part of that line which isn't yet processed, so the point of error is exactly at the line break."

%==============================================================================%
% Preamble
%==============================================================================%
% Options:
%     Pass a list of these separated by commas into the documentclass brackets
% Critical Options:
%     dissertation   - PhD Theses.
%     msthesis       - Master's Thesis
%     lackscommittee - no committee; often goes with Master's Thesis
%     copyright      - include copyright page. NOTE: You must customize this
%                      yourself under makecopyrightpage in uothesis.cls
%     final          - increases font size to 12pt, makes it twosided
%     approved       - Add the approval prefatory page (when you're done!)
% Extra Formatting Options:
%     sc             - use smallcaps instead of uppercase for chapter
%                      titles and stuff.
%     justified      - If you want to justify the text
%     bound          - Change for binding and printing. Does not comply with UO
%     amstex         - use amsmath, amssymb, amsthm Since it's in the .cls,
%                      they're bound early with RequirePackage. See also
%                      MATH EQUATIONS AND THEOREMS
%     chemistry      - use mhchem with ACS-style citations: superscript numbers
%                      for in-text citations with a numbered references cited
%                      section. Also loads mhchem.
%     apacite        - use APA style citations. If this is not included, you
%                      need to change this file a little; see the BIBLIOGRAPHY
%                      section.  You may also need to edit the makefile.
%     notables       - Do not include a "List of Tables" page
%     nofigures      - Do not include a "List of Figures" page
%     listings       - Include a "List of Source Code Listings" page. This
%                      requires you to add the following into this file:
%                    \usepackage{listings}
%                    \renewcommand{\lstlistoflistings}{\begingroup
%                    \tocfile{\lstlistingname}{lol}
%                    \endgroup}
% Notes:
%     - `draftcopy` is incompatible with `final`
%     - `msthesis` is incompatible with `dissertation`
%     - pick exactly one of `apacite`, `chemistry`, or nothing, if using a
%       custom citation style.
%     - ...and probably more.

% Examples:
\documentclass[dissertation, final, copyright]{uothesis} % For final copies

%\documentclass[dissertation, draftcopy]{uothesis} % For draft copies (enables line numbering, and puts black bars where there is text that overflows a line where latex can't figure out how to break it onto another line (in non-draft modes, this will result in an "overfull hbox" error, so draft mode is a good way of spotting these, following http://tex.stackexchange.com/a/39/56363)

%\documentclass[msthesis, lackscommittee, approved, final]{uothesis} % Example for Masters thesis that does not include a committee.

%------------------------------------------------------------------------------%
% PACKAGES
%------------------------------------------------------------------------------%
\usepackage[USenglish,UKenglish]{babel}
\usepackage{mathtools,amsmath,amsfonts,amsthm,amssymb,bm, bbm}
\usepackage{dcolumn,booktabs,longtable}
\usepackage[figurewithin=chapter,tablewithin=chapter]{caption}
%\usepackage[singlelinecheck=false]{caption}
%  \captionsetup[subfigure]{singlelinecheck=on, labelfont=normalfont}
%  \captionsetup[figure]{labelfont=it}
\usepackage{placeins}
\usepackage{graphicx}
\usepackage[space]{grffile} % allow spaces in graphics filenames.
\usepackage{rotating}
\usepackage{enumitem}
\usepackage{epstopdf}
\usepackage{ctable}
\usepackage{appendix}
\usepackage{setspace}
\usepackage[normalem]{ulem}
\usepackage{tabularx,xspace,multirow}
\usepackage{array}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{listings}

% Added by Jacob L. following https://tex.stackexchange.com/questions/148314/undefined-control-sequence-in-printbibliography-biblatex to allow UTF-8 (non-ASCII) characters in the bibliography .bib file.
\usepackage[utf8]{inputenc}

%------------------------------------------------------------------------------%
% BIBLIOGRAPHY
%------------------------------------------------------------------------------%
%--- You need to specify these if your dissertation is something other than
%--- apacite+bibtex, but these may be helpful for anything nonstandard.
%
%--- For example: If using biblatex, you need to manually fix spacing and ensure
%--- bibitems do not straddle page breaks and show up in TOC
% \usepackage{bibspacing}
% \setcounter{secnumberdepth}{4}
% \patchcmd{\bibsetup}{\interlinepenalty=5000}{\interlinepenalty=10000}{}{}
% \setlength\bibitemsep{0.5\baselineskip}
% \usepackage{tocloft}
% \renewcommand{\cftchapfont}{\normalsize}
% \renewcommand{\cftchapleader}{\cftdotfill{\cftdotsep}} % for chapters
% \renewcommand*{\numberline}[1]{\hb{#1  \hfil}}
%
%--- Or, if you want to change the citation style to e.g. acm
% \bibliographystyle{acm}
% Use biblatex for references - change style= as appropriate
\usepackage[natbib=true,backend=biber,sorting=nyt,style=apa,sortcites=true]{biblatex}
\addbibresource{dissertation.bib}

%------------------------------------------------------------------------------%
% MATH EQUATIONS AND THEOREMS (.cls also restructures theorem layout)
%------------------------------------------------------------------------------%
%--- Change \align{} and \equation{} spacing
\usepackage{etoolbox}
\newcommand{\zerodisplayskips}{%
  \setlength{\abovedisplayskip}{3pt}
  \setlength{\belowdisplayskip}{3pt}
  \setlength{\abovedisplayshortskip}{3pt}
  \setlength{\belowdisplayshortskip}{3pt}}
\appto{\normalsize}{\zerodisplayskips}
\appto{\small}{\zerodisplayskips}
\appto{\footnotesize}{\zerodisplayskips}

\usepackage{lineno}
%\usepackage{authblk}
\usepackage{xparse}
\usepackage{xpunctuate}
\usepackage{wrapfig}

\usepackage[hidelinks]{hyperref}
\usepackage[all]{hypcap}
\usepackage{amsmath}
\usepackage{cleveref}
\usepackage{flafter}
\usepackage{floatrow}
\usepackage{cancel}
\usepackage{pdfpages}
\usepackage{lscape}
\usepackage{fancyhdr}% http://ctan.org/pkg/fancyhdr
\usepackage{bookmark}
\fancypagestyle{pdflandscape}{%
\fancyhf{}% Clear header/footer
  \fancyfoot{% Footer
    \makebox[\textwidth][r]{% Right
      \rlap{\hspace{\footskip}% Push out of margin by \footskip
        \smash{% Remove vertical height
          \raisebox{\dimexpr.5\baselineskip+\footskip+.5\textheight}{% Raise vertically
            \rotatebox{90}{\thepage}}}}}}% Rotate counter-clockwise
  \renewcommand{\headrulewidth}{0pt}% No header rule
  \renewcommand{\footrulewidth}{0pt}% No footer rule
}
%\usepackage[position=top, label font=bf,labelformat=simple]{subfig}
%%%
%\graphicspath{ {./figures/} }
%\floatsetup[figure]{style=plain, subcapbesideposition=top}
%\floatsetup[table]{style=Plaintop}
% local definitions
\newcommand{\msprime}[0]{\texttt{msprime}\xspace}
\newcommand{\tskit}[0]{\texttt{tskit}\xspace}
\newcommand{\slim}[0]{\texttt{SLiM}\xspace}
\newcommand{\pyslim}[0]{\texttt{pyslim}\xspace}
\newcommand{\allel}[0]{\texttt{scikit-allel}\xspace}
\newcommand*{\eg}{e.g.\xcomma}
\newcommand*{\ie}{i.e.\xcomma}
\NewDocumentCommand{\plcref}{m O{\empty}}{(\Cref{#1}{#2})}
\NewDocumentCommand{\lcref}{m O{\empty}}{\Cref{#1}{#2}}
\newcommand{\comment}[1]{}
\newcommand{\beginsupplement}{%
    \setcounter{table}{0}
    \renewcommand{\thetable}{S\arabic{table}}%
    \setcounter{figure}{0}
    \renewcommand{\thefigure}{S\arabic{figure}}%
}

\newcommand{\E}{\operatorname{E}}

\newcommand{\Var}{\operatorname{Var}}

\newcommand{\Cov}{\operatorname{Cov}}
\newcommand{\Cor}{\operatorname{Cor}}

\newcommand{\SD}{\operatorname{SD}}

\newcommand{\expnumber}[2]{{#1}\times10^{#2}}

\newcommand{\pianc}{\pi^{\mathrm{anc}}}

\def\fillandplacepagenumber{%
 \par\pagestyle{empty}%
 \vbox to 0pt{\vss}\vfill
 \vbox to 0pt{\baselineskip0pt
   \hbox to\linewidth{\hss}%
   \baselineskip\footskip
   \hbox to\linewidth{%
     \hfil\thepage\hfil}\vss}}


% from http://tex.stackexchange.com/questions/43648/why-doesnt-lineno-number-a-paragraph-when-it-is-followed-by-an-align-equation/55297#55297
\ifcsname{patchAmsMathEnvironmentForLineno}\endcsname
    \newcommand*\patchAmsMathEnvironmentForLineno[1]{%
      \expandafter\let\csname old#1\expandafter\endcsname\csname #1\endcsname
      \expandafter\let\csname oldend#1\expandafter\endcsname\csname end#1\endcsname
      \renewenvironment{#1}%
         {\linenomath\csname old#1\endcsname}%
         {\csname oldend#1\endcsname\endlinenomath}}%
    \newcommand*\patchBothAmsMathEnvironmentsForLineno[1]{%
      \patchAmsMathEnvironmentForLineno{#1}%
      \patchAmsMathEnvironmentForLineno{#1*}}%
    \AtBeginDocument{%
    \patchBothAmsMathEnvironmentsForLineno{equation}%
    \patchBothAmsMathEnvironmentsForLineno{align}%
    \patchBothAmsMathEnvironmentsForLineno{flalign}%
    \patchBothAmsMathEnvironmentsForLineno{alignat}%
    \patchBothAmsMathEnvironmentsForLineno{gather}%
    \patchBothAmsMathEnvironmentsForLineno{multline}%
\fi

\newcommand{\savenumberline}{}% reserve global name
